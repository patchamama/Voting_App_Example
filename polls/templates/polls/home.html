{% extends 'polls/base.html' %}

{% block content %}
  <h2>Welcome, {{ user.username }}!</h2>
  <p>You are logged in.</p>

  <hr>

  <h3>Candidates</h3>
  {% if user_vote %}
    <p>You have already voted for {{ user_vote.candidate.name }}.</p>
  {% else %}
    <form method="post">
      {% csrf_token %}
      {% for candidate in candidates %}
        <input type="radio" name="candidate" id="candidate{{ candidate.id }}" value="{{ candidate.id }}">
        <label for="candidate{{ candidate.id }}">{{ candidate.name }}</label><br>
      {% endfor %}
      <button type="submit">Vote</button>
    </form>
  {% endif %}

  <hr>

  <h3>Results</h3>
  <ul>
    {% for candidate in candidates %}
      <li>{{ candidate.name }}: {{ candidate.vote_set.count }} vote{{ candidate.vote_set.count|pluralize }}</li>
    {% endfor %}
  </ul>
{% endblock %}